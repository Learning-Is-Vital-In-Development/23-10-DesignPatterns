# CH 02. 옵저버 패턴

## 내용 정리

### 풀방식 양방향 참조의 문제 가능성?
해당 양방향 참조 상황에서 문제는 없을 것 같다.
주제가 있고 옵저버가 인터페이스 리스트를 받으니까 그럴 일은 없지 않을까? 
옵저버 패턴 학습중 옵저버 패턴에서 서브젝트가 하는 행위가 있는데 컨테이너가 있으면 컨테이너 추가하고 삭제하고 알려주고 하는. 행위들은 서브젝트의 핵심이니까 인터페이스로 분리를 했다. 옵저버 패턴 갖추기 위해서는 등록하고 제거하는 기능의 강제가 필요해서 인터페이스를 사용한다.

## 정찬미님 : 해당 양방향 참조 상황에서 문제는 안 생길듯하다. 
더불어 일반적인 상황에서 양방향 참조는 자주 사용되고, 메모리 상 문제가 없다. (JPA 양방향 참조)

다만 `양방향 참조`에만 집중해봤을 때 프로그래머가 악용을 할 구석이 있다고 생각이 들긴하다. 일단 의존성을 양방향으로 가졌으니까 runtime에서 악의(?)를 가지고 반복적으로 생성하고, 사용하면 메모리에 영향이 갈 가능성이 있어보임.

> 순환참조문제 : 서로 순환되어 참조할 경우 생기는 문제
> 스프링의 빈 생성 과정 중에는 compile 타임에 에러를 뱉어준다. runtime에는 문제가 생기지 않는다.

> 한예성님 : 둘 다 서로를 계속 참조하니까 가비지 컬렉터에서 삭제 안 될 수도 있다?
> 정찬미님 : 지금 확결을 내리긴 어려운 것 같다. 

## 한예성님 : 푸쉬풀방식 옵저버 패턴이랑 비슷한 펍/섭패턴 둘 중 어느걸 쓰는지 궁금하다
실제 코드에서는 펍(Pub)/섭(Sub)이 일반적인 구현이다.
> Publisher / Subscriber 패턴 : Publisher와 Subscriber가 직접적으로 연결되지 않고, 중간 계층(예: 메시지 큐, 브로커)를 통해 메시지를 비동기적으로 전달한다. 
큐로 던지고 처리하는 느낌으로(옵저버와 다르게 하나의 레이어 추가) 호출이 되었을 때 처리를 해주는 패턴으로 옵저버와는 거리가 먼 걸 사용

## 옵저버 패턴의 장단점
단점 : 무작위 (순서x) 알람을 받음
장점 : ocp구현 가능

## 김진규님 : `동적 패턴`의 의미
- 옵저버는 객체의 집합들을 미리 알 수 없거나 본격적으로 변경되는 경우가 잦은 경우에 사용된다.(동적패턴의 의미)
- 최혁님 : 런타임에 클래스를 막 넣고 빼고 하는 과정을 통해 실제로 동작을 막 변경시키고 그런 경우가 많은지?
- 정찬미님, 김진규님 : 그렇지 않았다.
- 한예성님 : 도진님이 수현님 질문에 답변 달아주신 계산기 예시를 들어보면, 가로버전(공학용계산기), 세로버전(일반계산기)에 따라 달라지는 경우 팩토리 패턴이 좋은 아이디어이다. 

## 데코레이터 패턴의 예시를 이야기해보자
코드를 개발할 때 이미 작성한 코드를 건드리기 싫은 경우 사용 
ex) 서비스 객체가 있는데 캐시를 고려하지 않았다가 비즈니스 로직이 달라져서 캐시를 고려해야할 때 기능 추가를 해야하는데 기존 코드를 고치는게 아니라 감싸서 서비스에 적용


## 객체지향에서 런타임 때 코드 변경없이 변경 가능에 대해서
실제로 동작 변경 시키는 경우가 많이 있는가? : 거의 없다.. 대부분 구현체를 그대로 썼음 실행시점에 정하기 보단 설계에서 정하고 시작하니까 동적으로 갈아 끼운적은 적다
보통 비즈니스 로직에 따르니까 로직을 갈아끼우지 동적으로 코드를 변경해서 사용한 적은 적다
대부분 구현으로 코드를 작성하면 if문으로 처리하고 인터페이스를 쓰면 실행시점에서 어떤 걸 썼는지 확인이 어렵다. 디버깅이 어려움

## 책의 데코레이터 패턴 예시(커피)가 적절한가?
- 첨가물이 늘면 늘수록 점점 클래스가 늘어난다 -> 그냥 직관적인 예시일 뿐
  - 데코레이터 패턴의 단점이라고 볼 수 있다. 첨가물이 늘어나서 수십개가 되면 클래스도 수십개가 되어버림. -> 그정도까지라면 원래 클래스도 수정되어야 하지 않을까.
- 캐싱 서비스는 적절한 예시로 보임


## MSA 적용을 하는 곳이 있는가?
관리가 힘들어서 모놀로식으로 가는 회사가 많고 실제 스터디원 분 회사 한 곳은 모놀로식으로 돌아감
참고 : [아마존이 모놀리스를 도입해서 클라우드 인프라 비용을 90% 절감](https://www.itworld.co.kr/t/61023/%EA%B0%9C%EB%B0%9C%EC%9E%90/293089)


## 참고 사이트
https://refactoring.guru/ko/design-patterns
