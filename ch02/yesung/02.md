---
marp: false

---
# ì˜µì €ë²„ íŒ¨í„´

## ì˜µì €ë²„ íŒ¨í„´ì´ë€?

í•œ ê°ì²´ì˜ ìƒíƒœê°€ ë°”ë€Œë©´ ê·¸ ê°ì²´ì— ì˜ì¡´í•˜ëŠ” ë‹¤ë¥¸ ê°ì²´ì—ê²Œ ì—°ë½ì´ ê°€ëŠ” ì¼ëŒ€ë‹¤ ì˜ì¡´ì„±ì„ ì •ì˜í•˜ëŠ” ë°©ì‹

---

## ì˜µì €ë²„ íŒ¨í„´ì˜ êµ¬ì„±ìš”ì†Œ - Subject

### Subject ê°ì²´
Subjectê°€ ì•Œê³  ìˆëŠ” ê²ƒ(ë©¤ë²„ ë³€ìˆ˜, í”„ë¡œí¼í‹°)  
â†’ Observerë“¤ì´ ê´€ì‹¬ìˆì–´í•˜ëŠ” íƒ€ê¹ƒ ì¸ ìƒíƒœê°’ì„ ê°€ì§€ê³  ìˆìŒ  
â†’ Observerë“¤ì„ ì €ì¥ í•  ì»¨í…Œì´ë„ˆë¥¼ ê°€ì§€ê³  ìˆìŒ  
  
Subject í•˜ëŠ” ì¼(ë©¤ë²„ í•¨ìˆ˜, ë©”ì†Œë“œ)  
â†’ Observerë¥¼ ì»¨í…Œì´ë„ˆì— ì¶”ê°€  
â†’ Observerë¥¼ ì»¨í…Œì´ë„ˆì— ì‚­ì œ  
â†’ ìƒíƒœê°’ì´ ë°”ë€Œì—ˆì„ë•Œ ì»¨í…Œì´ë„ˆë¥¼ ìˆœíšŒí•˜ë©° ë“±ë¡ëœ ì˜µì €ë²„ë“¤ì—ê²Œ ì•Œë¦¬ê¸°  
â†’ ìƒíƒœê°’ì— ëŒ€í•œ getterì™€ setterê°€ ìˆì„ ìˆ˜ ìˆë‹¤.  

---
## ì˜µì €ë²„ íŒ¨í„´ì˜ êµ¬ì„±ìš”ì†Œ - Observer

### Observer ê°ì²´
Observerê°€ ì•Œê³  ìˆëŠ” ê²ƒ(ë©¤ë²„ ë³€ìˆ˜, í”„ë¡œí¼í‹°)  
â†’ ì—†ë‹¤.  
Observer í•˜ëŠ” ì¼(ë©¤ë²„ í•¨ìˆ˜, ë©”ì†Œë“œ)  
â†’ ì•Œë¦¼ì„ ë°›ì•˜ì„ë•Œ ìˆ˜í–‰ í•  ì¼ì´ ì •í•´ì ¸ìˆë‹¤.

---
# ì±…ì— ë‚˜ì˜¨ ì˜ˆì‹œ ë¶„ì„
ì˜µì €ë²„ íŒ¨í„´ì´ í•„ìš”í•œ ê²½ìš°
```java
public class WeatherData {

    public void measurementsChanged() {
		    float temp = getTemperature(); //ì˜¨ë„ ê°€ì ¸ì˜¤ê¸°
		    float humidity = getHumidity(); //ìŠµë„ ê°€ì ¸ì˜¤ê¸°
		    float pressure = getPressure(); //ê¸°ì•• ê°€ì ¸ì˜¤ê¸°
		
		    //ë””ìŠ¤í”Œë ˆì´ ê°±ì‹ 
		    currentConditionsDisplay.update(temp, humidity, pressure);
		    statisticsDisplay.update(temp, humidity, pressure);
		    forecastDisplay.update(temp, humidity, pressure);
		    // <------ ë§Œì•½ ìƒˆë¡œìš´ ì¢…ë¥˜ì˜ Displayê°€ ì¶”ê°€ë˜ë©´ ì—¬ê¸°ë„ ë˜ ì¶”ê°€ í•´ì•¼í•¨. ğŸ˜“
    }
}
```

---

# ì˜µì €ë²„ íŒ¨í„´ì„ ì ìš©í•´ë³´ì

---

# ì˜µì €ë²„ íŒ¨í„´ ì ìš© - ì¸í„°í˜ì´ìŠ¤ ì •ì˜
```java
public interface Subject {
    public void registerObserver(Observer o);
    public void removeObserver(Observer o);
    public void notifyObservers();
}

public interface Observer {
    void update(float temperature, float humidity, float pressure);
}

public interface DisplayElement {
    public void display();
}
```

---

# ì˜µì €ë²„ íŒ¨í„´ ì ìš© - Subject êµ¬í˜„
```java
package ObserverPattern;

import java.util.ArrayList;
import java.util.List;

public class WeatherData implements Subject {

    private float temperature; // Subjectê°€ ì•Œê³  ìˆëŠ” ê²ƒ 1 : íƒ€ê¹ƒì´ ë˜ëŠ” ìƒíƒœê°’ ë“¤
    private float humidity;
    private float pressure;
    private List<Observer> observers; // Subjectê°€ ì•Œê³  ìˆëŠ” ê²ƒ 2 : ì˜µì €ë²„ ë‹´ì„ ì»¨í…Œì´ë„ˆ


    public WeatherData() {
        observers = new ArrayList<Observer>();
    }

    @Override // Subjectê°€ í•˜ëŠ” ì¼ 1 : ì˜µì €ë²„ë¥¼ ì»¨í…Œì´ë„ˆì— ë“±ë¡
    public void registerObserver(Observer o) {
        observers.add(o);
    }

    @Override // Subjectê°€ í•˜ëŠ” ì¼ 2 : ì˜µì €ë²„ë¥¼ ì»¨í…Œì´ë„ˆì—ì„œ ëºŒ
    public void removeObserver(Observer o) {
        observers.remove(o);
    }

    @Override
    public void notifyObservers() { // Subjectê°€ í•˜ëŠ” ì¼ 3 : ì»¨í…Œì´ë„ˆë¥¼ ìˆœíšŒ í•˜ë©° ì˜µì €ë²„ì—ê²Œ ì•Œë¦¬ê¸°
        for(Observer observer: observers) {
            observer.update(temperature, humidity, pressure); // ìƒíƒœê°’ë“¤ì„ Objectì—ê²Œ push í•´ì¤€ë‹¤
        }

    }

    public void measurementsChanged() {
        notifyObservers();
    }


        // ê·¸ ì™¸ ìƒíƒœê°’ì„ ë‹¤ë£¨ê¸°ìœ„í•œ getter setter

    public void setWeatherData(float temperature, float humidity, float pressure) {
        this.temperature = temperature;
        this.humidity = humidity;
        this.pressure = pressure;

        measurementsChanged();
    }

    public float getTemperature() {
        return this.temperature;
    }

    public float getHumidity() {
        return this.humidity;
    }

    public float getPressure() {
        return this.pressure;
    }
}
```

---

# ì˜µì €ë²„ íŒ¨í„´ ì ìš© - Object êµ¬í˜„
```java
package ObserverPattern.display;

import ObserverPattern.DisplayElement;
import ObserverPattern.Observer;

public class CurrentConditionsDisplay implements Observer, DisplayElement {

    private float temperature;
    private float humidity;

    @Override
    public void update(float temperature, float humidity, float pressure) {  // Subjectë¡œ ë¶€í„° push ë°›ì€ ë°ì´í„° ê°€ì§€ê³  ê°ìì˜ ì¼ ìˆ˜í–‰
        this.temperature = temperature;
        this.humidity = humidity;

        display();
    }

    @Override
    public void display() {
        System.out.println("í˜„ì¬ ìƒíƒœ:  ì˜¨ë„ "+temperature+"F, ìŠµë„ "+humidity+"%");
    }
}
```

---
# ì‹¤í–‰ ë¶€ë¶„

```java
public static void main(String[] args) {
    WeatherData weatherData = new WeatherData(); // Subject ì¸ìŠ¤í„´íŠ¸ ìƒì„±

    Observer currentConditionsDisplay = new CurrentConditionsDisplay(); // Observer ì¸ìŠ¤í„´íŠ¸ ìƒì„±
    Observer statisticsDisplay = new StatisticsDisplay(); // Observer ì¸ìŠ¤í„´íŠ¸ ìƒì„±


    weatherData.registerObserver(currentConditionsDisplay); // Observerë¥¼ Subjectì— ë“±ë¡
    weatherData.setWeatherData(3, 5, 7);

    System.out.println("í†µê³„ ë””ìŠ¤í”Œë ˆì´ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤.");
    weatherData.registerObserver(statisticsDisplay); // Observer ë¥¼ Subjectì— ë“±ë¡
    System.out.println("ê¸°ìƒ ë°ì´í„°ê°€ ì—…ë°ì´íŠ¸ ë©ë‹ˆë‹¤.");
    weatherData.setWeatherData(20, 30, 80);

    System.out.println("í˜„ì¬ ìƒíƒœ ë””ìŠ¤í”Œë ˆì´ë¥¼ ì œê±°í•©ë‹ˆë‹¤.");
    weatherData.removeObserver(currentConditionsDisplay); // Observer ë¥¼ Subjectì—ì„œ ì œê±°
    weatherData.setWeatherData(25, 30, 80);

}
```

---

# ì˜µì €ë²„ ë°ì´í„° ë°©ì‹ì˜ í‘¸ì‹œ(push) vs í’€(pull)

ì§€ê¸ˆ ë§Œë“¤ì–´ ë†“ì€ WeatherData ë””ìì¸ì€ í•˜ë‚˜ì˜ ë°ì´í„°ë§Œ ê°±ì‹ í•´ë„ ë˜ëŠ” ìƒí™©ì—ì„œë„ update ë©”ì†Œë“œì— ëª¨ë“  ë°ì´í„°ë¥¼ ë³´ë‚´ë„ë¡ ë˜ì–´ ìˆìŠµë‹ˆë‹¤. 

ë§Œì•½ í’ì† ê°™ì€ ìƒˆë¡œìš´ ë°ì´í„°ê°€ ì¶”ê°€ë˜ë©´ ëŒ€ë¶€ë¶„ì˜ update ë©”ì†Œë“œì—ì„œ ìƒˆë¡œ ì¶”ê°€ëœ ê·¸ í’ì† ë°ì´í„°ë¥¼ ì“°ì§€ ì•Šë”ë¼ë„ ëª¨ë“  update ë©”ì†Œë“œë¥¼ ë°”ê¿”ì•¼ í•œë‹¤. ëŒ€ì²´ë¡œ ì˜µì €ë²„ê°€ í•„ìš”í•œ ë°ì´í„°ë§Œ ê³¨ë¼ì˜¤ë„ë¡ í•˜ëŠ” pull ë°©ë²•ì´ ë” ë‚˜ì€ ë°©ë²•ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

---

# pull ë°©ì‹ìœ¼ë¡œ ë°”ê¿”ë³´ê¸°
```java
// Observer.java
public interface Observer {
    void update(); // (1) Observerì—ì„œëŠ” ì´ì œ ì•Œë¦¼ ë°›ì„ë•Œ ì¸ìˆ˜ ì•ˆ ë°›ìŒ
}


// WeatherData.java
@Override
public void notifyObservers() {
    for(Observer observer: observers) {
        observer.update(); // (2) Observerê°€ ì¸ìˆ˜ ë°›ì•˜ë˜ ë¶€ë¶„ ì‚­ì œ
    }

}
```

```java
package ObserverPattern.display;

import ObserverPattern.DisplayElement;
import ObserverPattern.Observer;
import ObserverPattern.WeatherData;

public class CurrentConditionsDisplay implements Observer, DisplayElement {

    private float temperature;
    private float humidity;
    private WeatherData weatherData; // (3) ì˜µì €ë²„ë„ ì´ì œ ì„œë¸Œì íŠ¸ë¥¼ ì•Œê³  ìˆìŒ! -> ì„œë¸Œì íŠ¸ë„ ì˜µì €ë²„ë¥¼ ì•Œê³ , ì˜µì €ë²„ë„ ì„œë¸Œì íŠ¸ë¥¼ ì•„ëŠ” ìƒí™©ì´ ë˜ì—ˆìŒ.

    public CurrentConditionsDisplay(WeatherData weatherData) {
        this.weatherData = weatherData;
    }

    @Override
    public void update() {
        this.temperature = weatherData.getTemperature(); // (4) updateê°€ í˜¸ì¶œ ë  ë•Œ ì˜µì €ë²„ê°€ ì•Œê³ ìˆëŠ” ì„œë¸Œì íŠ¸ì—ì„œ ì§ì ‘ êº¼ë‚´ì˜¨ë‹¤.
        this.humidity = weatherData.getHumidity();

        display();
    }

    @Override
    public void display() {
        System.out.println("í˜„ì¬ ìƒíƒœ:  ì˜¨ë„ "+temperature+"F, ìŠµë„ "+humidity+"%");
    }
}
```

## ì˜µì €ë²„ë„ ì´ì œ ì„œë¸Œì íŠ¸ë¥¼ ì•Œê³  ìˆìŒ! 
â†’ ì„œë¸Œì íŠ¸ë„ ì˜µì €ë²„ë¥¼ ì•Œê³ , ì˜µì €ë²„ë„ ì„œë¸Œì íŠ¸ë¥¼ ì•„ëŠ” ìƒí™©ì´ ë˜ì—ˆë‹¤.  
â†’ ğŸ¤” ìˆœí™˜ì°¸ì¡°ê°€ ì¼ì–´ë‚˜ëŠ” ìƒí™©ì¸ë° ê³¼ì—° ì´ ë°©ì‹ì´ ì¢‹ì€ ë°©ì‹ì¼ê¹Œ?

---

# ì˜µì €ë²„ íŒ¨í„´ì˜ íŠ¹ì§•ì„ ì •ë¦¬ í•´ë³´ë©´â€¦

## 1. ì¼ ëŒ€ ë‹¤ ê´€ê³„
í•˜ë‚˜ì˜ Subjectê°€ ì—¬ëŸ¬ê°œì˜ Objectë¥¼ ì•Œê³  ìˆë‹¤.

## 2. ëŠìŠ¨í•œ ê²°í•©
Observer íŒ¨í„´ì—ì„œ SubjectëŠ” Objectë“¤ì„ has ê´€ê³„ë¡œ ê°€ì§€ê³  ìˆê³ , ìƒíƒœ ê°’ì´ ë°”ë€Œì—ˆì„ ë•Œ ì»¨í…Œì´ë„ˆë¥¼ ìˆœíšŒí•˜ë©° ë“±ë¡ ëœ Observerê°€ ì œê³µí•œ update í•¨ìˆ˜ë§Œ í˜¸ì¶œ í•˜ë©´ ë˜ê¸° ë•Œë¬¸ì— ëŠìŠ¨í•œ ê²°í•©

## 3. ì¶œíŒ-êµ¬ë… íŒ¨í„´(Pub-Sub íŒ¨í„´)ì´ë‘ ë¹„ìŠ·í•˜ì§€ë§Œ ë‹¤ë¦„
ObserveríŒ¨í„´ì€ Observerì™€ Subjectê°€ ì„œë¡œë¥¼ ì¸ì§€í•˜ì§€ë§Œ,  
Pub-SubíŒ¨í„´ì˜ ê²½ìš° Observerì™€ Subjectê°€ ì„œë¡œë¥¼ ì „í˜€ ëª°ë¼ë„ ìƒê´€ì—†ìŠµë‹ˆë‹¤.

*ê·¸ ì¤‘ê°„ì— ì´ë²¤íŠ¸ ë³„ ì±„ë„ë¡œ Message Queë¥¼ í™œìš©
<img src='./observer-01.png' width=800/>

--- 

# Push-Pull ë°©ì‹ê³¼ Pub-Sub ë°©ì‹

- Push-Pull ë°©ì‹  
=> ì±…ì— ë‚˜ì˜¨ ì˜ˆì‹œì™€ ê°™ì´ loop ìˆœíšŒ í•˜ë©° objectì˜ update í•¨ìˆ˜ í˜¸ì¶œ
=> loop ìˆœíšŒ í•„ìš”

- Pub-Sub  
=> ì´ë²¤íŠ¸ ë°œí–‰ êµ¬ë…ì˜ í˜•íƒœ
=> rxjs ì˜ˆì‹œ