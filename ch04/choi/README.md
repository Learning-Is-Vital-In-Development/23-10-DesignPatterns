---
marp: true
---

# 팩토리 메서드 패턴과 추상 팩토리 패턴

## 최 혁

---

# 상황 1

    피자 가게 운영을 위해 피자 주문이 들어오면 피자 종류에 따라 다르게 조리하여 배송하는 시스템

**모든 피자를 Pizza 추상 클래스를 상속하여 만든다면?**

- **주문에 따라 다른 인스턴스를 주입하는 코드가 있는 클래스에 많은 의존성이 추가된다!**
- **피자가 추가되거나 변경되면 클래스도 변경점이 생긴다!**
  <br>

**따라서 객체 생성을 처리할 클래스(팩토리)를 만들어 모든 의존성을 전달한다**

ㄴ 다만 단순히 팩토리를 만들어 해결하는 방식은 팩토리 패턴이 아니다.

---

# 상황 2

    피자 가게가 큰 인기를 얻게 되어 다른 지역에 분점을 냈다. 다른 지역 피자 가게는 그들만의
    독자적인 스타일로 피자를 만들기에 같은 종류라도 가게마다 스타일이 다른 피자를 만들어야 한다.

**피자 종류에 따라 다른 피자 인스턴스를 반환하는 팩토리 메서드가 피자 가게까지 신경써야 하는 상황이 발생했다! 이 경우 피자 가게를 추상화하여 각 피자 가게들이 피자를 만드는 방법을 독자적으로 선택하도록 변경해야 한다!**

---

# 팩토리 메서드 패턴

    객체를 생성할 때 필요한 인터페이스를 만들고 어떤 클래스의 인스턴스를 만들지 서브클래스에서 결정하도록
    위임하는 방식

**결국 사용하는 서브클래스에 따라 생산되는 객체 인스턴스가 결정된다!**

- 구상 생산자 클래스가 하나밖에 없어도 해당 패턴을 사용해도 될까?

그렇다 하더라도 팩토리 메서드 패턴은 유용하다! 제품을 생산하는 부분과 사용하는 부분을 분리하여 느슨하게 결합시켰기 때문이다.

- 그럼 간단한 팩토리(클래스)와 팩토리 메서드 패턴의 차이점은 무엇인가?

둘은 상당히 비슷하지만 팩토리를 여러 번 재사용이 가능한 프레임워크를 만들 수 있다는 점에서 팩토리 메서드 패턴이 유연하다.

- 팩토리 메서드 패턴의 단점은?

패턴을 구현하기 위해 많은 새로운 자식 클래스들을 도입해야 하므로 코드가 더 복잡해질 수 있다.

---

# 의존성 뒤집기 원칙(Dependency INversion Principle)

    추상화된 것에 의존하게 만들고 구상 클래스(new)에 의존하지 않게 만든다

### 의존성 뒤집기 원칙을 지키는 방법

- 변수에 구상 클래스의 레퍼런스를 저장하지 말자
- 구상 클래스에서 유도된 클래스를 만들지 말자
- 베이스 클래스에 이미 구현되어 있는 메서드를 오버라이딩하지 말자

**가만 보면 해당 가이드라인을 지키지 않을 때도 많다! (String, Date 등..) 하지만 우리가 만들고 있는 클래스가 `바뀔 수 있다면` 팩토리 메서드 패턴을 써서 캡슐화하자**

---

# 상황 3

    피자 가게에 따라 피자를 만드는데 사용되는 원재료가 바뀌어야 한다면?

1. 모든 원재료를 생산하는 팩토리용 인터페이스를 정의한다.
2. 팩토리에서 사용할 원재료 클래스를 구현한다.
3. 원재료 팩토리를 PizzaStore 코드에서 사용하도록 모든 것을 하나로 묶는다.

---

### 예시 코드

```java
public class NYPizzaStore extends PizzaStore {

    protected Pizza createPizza(String item) {
        Pizza pizza = null;
        PizzaIngredientFactory ingredientFactory =
            new NYPizzaIngredientFactory();
        if (item.equals("cheese")) {
            pizza = new CheesePizza(ingredientFactory);
        } else if (item.equals("veggie")) {
            pizza = new VeggiePizza(ingredientFactory);
        }
        ...
        return pizza;
    }

}
```

---

# 추상 팩토리 패턴

    구상 클래스에 의존하지 않고도 서로 연관되거나 의존적인 객체로 이루어진 제품군을 생산하는
    인터페이스를 제공한다.

- 팩토리 메서드 패턴과의 공통점
  - 애플리케이션을 특정 구현으로부터 분리한다.
- 팩토리 메서드 패턴과의 차이점
  - 팩토리 메서드는 상속으로, 추상 팩토리는 구성으로 객체를 만든다.
